<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ParkEase.Page.CreateMapPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:ParkEase.Controls;assembly=ParkEase"
    xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:validation="clr-namespace:InputKit.Shared.Validations;assembly=InputKit.Maui"
    xmlns:vm="clr-namespace:ParkEase.ViewModel"
    xmlns:sfTabView="clr-namespace:Syncfusion.Maui.TabView;assembly=Syncfusion.Maui.TabView"
    x:DataType="vm:CreateMapViewModel">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="300" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="400" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  Tabs  -->
        <sfTabView:SfTabView Grid.Row="0" Grid.Column="0">
            <sfTabView:SfTabItem Header="Details">
                <ScrollView>
                    <StackLayout Padding="10" BackgroundColor="#EFEFEF">
                        <!--  General information  -->
                        <Label
                            Margin="10"
                            FontSize="20"
                            HorizontalOptions="Center"
                            Text="Create Map Editor" />

                        <Picker ItemsSource="{Binding PropertyAddresses}" Title="Select a property address">
                        </Picker>

                        <material:TextField
                            Title="Company Name"
                            Margin="20,8"
                            AllowClear="True"
                            IsReadOnly="False"
                            Text="{Binding CompanyName}"
                            WidthRequest="350">
                            <validation:RequiredValidation />
                        </material:TextField>

                        <material:TextField
                            Title="Address"
                            Margin="0,8"
                            AllowClear="True"
                            IsReadOnly="False"
                            Text="{Binding Address}"
                            WidthRequest="350">
                            <validation:RequiredValidation />
                        </material:TextField>

                        <material:TextField
                            Title="City"
                            Margin="0,8"
                            AllowClear="True"
                            IsReadOnly="False"
                            Text="{Binding City}"
                            WidthRequest="350">
                            <validation:RequiredValidation />
                        </material:TextField>

                        <material:TextField
                            Title="Parking Fee"
                            Margin="0,8"
                            AllowClear="True"
                            IsReadOnly="False"
                            Text="{Binding Fee}"
                            WidthRequest="350">
                            <validation:RequiredValidation />
                        </material:TextField>

                        <material:TextField
                            Title="Limit Hour"
                            Margin="0,20"
                            AllowClear="True"
                            IsReadOnly="False"
                            Text="{Binding LimitHour}"
                            WidthRequest="350">
                            <validation:RequiredValidation />
                        </material:TextField>

                        

                    </StackLayout>
                </ScrollView>
            </sfTabView:SfTabItem>

            <sfTabView:SfTabItem Header="Floor Info">
                <StackLayout Padding="20">
                    <!--  Create floor section  -->
                    <Label
                        Margin="20,20,20,4"
                        FontSize="14"
                        HorizontalOptions="Start"
                        Style="{StaticResource SecondaryDarkText}"
                        Text="Enter your parking level (ex: B1, B2, F1, F2, or Ground)" />

                    <material:TextField
                        Title="Level"
                        Margin="20,4,20,10"
                        AllowClear="True"
                        IsReadOnly="False"
                        Text="{Binding Floor}"
                        WidthRequest="200">
                        <validation:RequiredValidation />
                    </material:TextField>
                    <Button
                        x:Name="UploadBtn"
                        Command="{Binding UploadImageClick}"
                        Text="Upload Image"
                        VerticalOptions="Center" />
                    <Button
                    Margin="50,50,50,30"
                    Command="{Binding SaveFloorInfoCommand}"
                    Text="Save"
                    VerticalOptions="Center"
                    WidthRequest="200" />
                </StackLayout>
            </sfTabView:SfTabItem>
        </sfTabView:SfTabView>

        <!-- Bottom Row -->
        <Border Grid.Row="1" Grid.Column="0"
        Stroke="#512BD4">
            <ScrollView>
                <StackLayout>
                        <!--  Rectangle Width Slider  -->
                        <Label x:Name="widthLabel"
                             Text="{Binding Source={x:Reference RectWidth},
                                     Path=Value,
                                     StringFormat='Width value: {0:F0}'}"
                             HorizontalOptions="Center"
                             VerticalOptions="Center" />
                        <Slider x:Name="RectWidth"
                         Margin="0,0,0,20"
                         Minimum="10"
                         Maximum="250"
                         Value="{Binding RectWidth}"/>  

                    <!--  Rectangle Height Slider  -->
                    <Label x:Name="heightLabel"
                     Text="{Binding Source={x:Reference RectHeight},
                             Path=Value,
                             StringFormat='Height value: {0:F0}'}"
                     HorizontalOptions="Center"
                     VerticalOptions="Center" />
                    <Slider x:Name="RectHeight"
                     Minimum="10"
                     Maximum="250"
                     Value="{BindingÂ RectHeight}"/>

                    <HorizontalStackLayout HorizontalOptions="Center">
                        <Button
                            x:Name="DeleteBtn"
                            Margin="10,20,0,0"
                            Command="{Binding RemoveRectangleClick}"
                            HorizontalOptions="Center"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Text="Delete"
                            WidthRequest="100" />
                        <Button
                            x:Name="ClearBtn"
                            Margin="10,20,10,0"
                            Command="{Binding ClearAllRectangleClick}"
                            HorizontalOptions="Center"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Text="Clear"
                            WidthRequest="100" />
                    
                    </HorizontalStackLayout>
                    <Button
                        x:Name="SubmitBtn"
                        Margin="10"
                        Command="{Binding SubmitCommand}"
                        Text="Submit"
                        WidthRequest="200"
                        HorizontalOptions="Center" />   
                </StackLayout>
            </ScrollView>
        </Border>

        <!-- GraphicsView -->
        <Border Grid.Row="0" Grid.Column="1"
                Grid.RowSpan="2"
                Stroke="#512BD4"
                BackgroundColor="WhiteSmoke">

            <controls:RecGraphicsView
                x:Name="RectangleDrawableView"
                ImageSource="{Binding ImgSourceData}"
                MinimumHeightRequest="700"
                MinimumWidthRequest="700"
                Rectangles="{Binding Rectangles}">
                <controls:RecGraphicsView.Drawable>
                    <controls:RectDrawable />
                </controls:RecGraphicsView.Drawable>
                <GraphicsView.GestureRecognizers>
                    <TapGestureRecognizer Buttons="Primary" Tapped="OnTapGestureRecognizerTapped" />
                </GraphicsView.GestureRecognizers>
            </controls:RecGraphicsView>
        </Border>

    </Grid>
</ContentPage>
